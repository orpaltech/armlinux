From 3118f1efdf79c6587b1b287676631eb02b63a291 Mon Sep 17 00:00:00 2001
From: Sergey Suloev <ssuloev@orpaltech.com>
Date: Tue, 16 Jan 2018 17:12:27 +0300
Subject: [PATCH] Fix raspberry pi3 mkspec

---
 mkspecs/devices/linux-rasp-pi3-g++/qmake.conf | 4 ++--
 1 file changed, 2 insertions(+), 2 deletions(-)

diff --git a/mkspecs/devices/linux-rasp-pi3-g++/qmake.conf b/mkspecs/devices/linux-rasp-pi3-g++/qmake.conf
index 2bb70ff..3f4a846 100644
--- a/mkspecs/devices/linux-rasp-pi3-g++/qmake.conf
+++ b/mkspecs/devices/linux-rasp-pi3-g++/qmake.conf
@@ -13,7 +13,7 @@ QMAKE_RPATHLINKDIR_POST += $$[QT_SYSROOT]/opt/vc/lib
 VC_LIBRARY_PATH         = /opt/vc/lib
 VC_INCLUDE_PATH         = =/opt/vc/include
 
-VC_LINK_LINE            = -L=$${VC_LIBRARY_PATH}
+VC_LINK_LINE            = -L=$${VC_LIBRARY_PATH} -Wl,-rpath,$${VC_LIBRARY_PATH}
 
 QMAKE_LIBDIR_OPENGL_ES2 = =$${VC_LIBRARY_PATH}
 QMAKE_LIBDIR_EGL        = $$QMAKE_LIBDIR_OPENGL_ES2
@@ -31,7 +31,7 @@ QMAKE_LIBS_OPENGL_ES2   = $${VC_LINK_LINE} -lGLESv2
 # The official opt vc EGL references GLESv2 symbols: need to link it
 QMAKE_LIBS_EGL          = $${VC_LINK_LINE} -lEGL -lGLESv2
 
-QMAKE_CFLAGS            = -march=armv8-a -mtune=cortex-a53 -mfpu=crypto-neon-fp-armv8
+QMAKE_CFLAGS            = -march=armv7-a -marm -mthumb-interwork -mfpu=vfpv4 -mtune=cortex-a7
 QMAKE_CXXFLAGS          = $$QMAKE_CFLAGS
 
 DISTRO_OPTS            += hard-float
-- 
2.15.1

